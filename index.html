<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>é£²æ–™å°å¹«æ‰‹</title>
  <link rel="icon" type="image/png" href="./icon.png">
  <link rel="apple-touch-icon" href="./icon.png">
  <link rel="apple-touch-icon" sizes="180x180" href="./icon.png">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap');
    
    :root{
      --bg:#fffef6; 
      --accent:#ff7aa2; 
      --muted:#6b6b6b; 
      --card:#ffffff; 
      --glass:rgba(255,255,255,0.85);
      --radius:14px; 
      --pad:16px; 
      font-family: 'Noto Sans TC', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }
    *{box-sizing:border-box}
    
    body{
      background:linear-gradient(160deg,#fffef6 0%, #f6fbff 100%);
      background-image: url('https://images.unsplash.com/photo-1542444590-4c2250d4f29e?crop=entropy&cs=tinysrgb&fit=max&w=1600&h=900&q=80');
      background-size: cover;
      background-position: center center;
      background-attachment: fixed;
      margin:0; padding:28px; color:#222;
    }
    .wrap{max-width:900px; margin:0 auto}

    header{display:flex; align-items:center; gap:12px; margin-bottom:18px}
    .logo{
      width:56px;
      height:56px;
      border-radius:12px;
      background: linear-gradient(135deg, #ff7aa2, #ffd98a);
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:700;
      color:white;
      font-size:20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.12);
    }
    h1{margin:0; font-size:20px}
    p.lead{margin:4px 0 0; color:var(--muted); font-size:13px}

    .card{
      background: rgba(255, 255, 255, 0.9);
      border-radius: var(--radius);
      padding: var(--pad);
      box-shadow: 0 6px 20px rgba(20,30,50,0.06);
      backdrop-filter: blur(8px);
    }
    form.controls{display:grid; grid-template-columns:repeat(3,1fr); gap:12px; margin-bottom:12px}
    label{display:block; font-size:12px; color:var(--muted); margin-bottom:6px}
    select, input[type=text]{
      width:100%; 
      padding:10px 12px; 
      border-radius:10px; 
      border:1px solid #eef2f5; 
      background:var(--glass);
      backdrop-filter: blur(6px);
    }
    .note{font-size:12px; color:var(--muted); margin-top:8px}

    .actions{display:flex; gap:10px; margin-top:10px}
    button{border:0; padding:10px 14px; border-radius:12px; cursor:pointer}
    .btn-primary{
      background: linear-gradient(90deg, var(--accent), #ffb48a);
      color: white;
      font-weight: 600;
      transition: background 0.3s;
    }
    .btn-primary:hover{
      background: linear-gradient(90deg, #ffb48a, var(--accent));
    }
    .btn-clear{background:transparent; color:var(--muted)}

    .result{margin-top:18px}
    table{width:100%; border-collapse:collapse; text-align:left}
    th,td{padding:12px 10px; border-bottom:1px dashed #f0f0f0}
    th{font-size:13px; color:var(--muted)}
    td .shop{display:block; font-weight:700}
    td .small{font-size:13px; color:var(--muted)}

    .error{color:#b30000; font-weight:700; margin-top:6px}
    .hint{font-size:12px; color:#b47;}

    @media (max-width:720px){
      form.controls{grid-template-columns:1fr} 
      header{gap:8px} 
      .logo{width:48px;height:48px}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">é£²</div>
      <div>
        <h1>é£²æ–™å°å¹«æ‰‹</h1>
        <p class="lead">è¼¸å…¥ç•¶å¤©å¤©æ°£ / èº«é«”ç‹€æ³ / æƒ…ç·’ï¼Œæˆ‘æœƒçµ¦ä½  3 å€‹å¥½å–çš„é£²æ–™ææ¡ˆ</p>
      </div>
    </header>

    <section class="card">
      <form id="prefs" class="controls" onsubmit="return false;">
        <div>
          <label for="weather">å¤©æ°£ï¼ˆå¿…å¡«ï¼‰</label>
          <select id="weather" aria-label="å¤©æ°£é¸æ“‡">
            <option value="">è«‹é¸æ“‡å¤©æ°£</option>
            <option value="hot">ç†±ï¼ˆæ‚¶ / ç‚ç†±ï¼‰</option>
            <option value="cool">æ¶¼ï¼ˆå¾®æ¶¼ / èˆ’çˆ½ï¼‰</option>
            <option value="cold">å†·ï¼ˆå¯’å†·ï¼‰</option>
            <option value="rain">ä¸‹é›¨ / æ½®æ¿•</option>
          </select>
          <div id="err-weather" class="error" aria-live="polite" style="display:none">! è«‹é¸æ“‡å¤©æ°£ä»¥ä¾¿æˆ‘çµ¦å‡ºåˆé©å»ºè­°ã€‚</div>
        </div>

        <div>
          <label for="body">èº«é«”ç‹€æ³ï¼ˆå¿…å¡«ï¼‰</label>
          <select id="body">
            <option value="">è«‹é¸æ“‡èº«é«”ç‹€æ³</option>
            <option value="normal">æ­£å¸¸ã€æƒ³æ¸…çˆ½</option>
            <option value="tired">ç–²å€¦ã€æƒ³æç¥</option>
            <option value="sore_throat">å–‰åš¨ä¸é© / æƒ³é¤Šè­·</option>
            <option value="digestive">è…¸èƒƒè¼ƒæ•æ„Ÿ / æƒ³æº«å’Œ</option>
          </select>
          <div id="err-body" class="error" style="display:none">! è«‹é¸æ“‡èº«é«”ç‹€æ³ï¼Œå®‰å…¨ç¬¬ä¸€ã€‚</div>
        </div>

        <div>
          <label for="mood">æƒ…ç·’ / èƒ½é‡ï¼ˆå¿…å¡«ï¼‰</label>
          <select id="mood">
            <option value="">è«‹é¸æ“‡æƒ…ç·’</option>
            <option value="happy">æ„‰å¿« / æƒ³æ”¾é¬†</option>
            <option value="stressed">ç·Šå¼µ / å£“åŠ›å¤§</option>
            <option value="sad">æƒ…ç·’ä½è½</option>
            <option value="calm">å¹³éœ / å†¥æƒ³</option>
          </select>
          <div id="err-mood" class="error" style="display:none">! è«‹é¸æ“‡æƒ…ç·’ï¼Œé€™æœƒå½±éŸ¿å£å‘³å»ºè­°ã€‚</div>
        </div>

      </form>

      <div class="actions">
        <button class="btn-primary" id="generate">ç”¢ç”Ÿ 3 å€‹å»ºè­°</button>
        <button class="btn-clear" id="reset">æ¸…é™¤</button>
      </div>

      <div class="result" id="resultArea" aria-live="polite"></div>

    </section>

  </div>

  <script>
  // 1. å®Œæ•´é£²æ–™è³‡æ–™åº«
  const DRINK_DATABASE = [
    { name: 'æª¸æª¬æ˜¥çƒé¾', shop: 'å¯ä¸å¯', price: 'M 45 / L 55', tags: { weather: ['hot', 'rain'], body: ['normal'], mood: ['happy', 'calm'] } },
    { name: 'ç†Ÿæˆç´…èŒ¶', shop: 'å¯ä¸å¯', price: 'M 25 / L 30', tags: { weather: ['cool', 'cold'], body: ['normal'], mood: ['calm'] } },
    { name: 'ç™½ç‰æ­è•¾', shop: 'å¯ä¸å¯', price: 'M 50 / L 60', tags: { weather: ['cool'], body: ['tired'], mood: ['sad', 'stressed'] } },
    { name: '8 å†°èŒ¶', shop: '50 åµ', price: 'M 50 / L 60', tags: { weather: ['hot'], body: ['normal', 'digestive'], mood: ['happy'] } },
    { name: 'å››å­£æ˜¥çæ³¢æ¤°', shop: '50 åµ', price: 'M 40 / L 50', tags: { weather: ['hot', 'cool'], body: ['tired'], mood: ['happy'] } },
    { name: 'æ¥Šæç”˜éœ² 2.0', shop: 'éº»å¤èŒ¶åŠ', price: 'L 80', tags: { weather: ['hot'], body: ['normal'], mood: ['happy', 'sad'] } },
    { name: 'é‡‘æ¡”æª¸æª¬', shop: 'éº»å¤èŒ¶åŠ', price: 'L 55', tags: { weather: ['cool', 'rain'], body: ['sore_throat'], mood: ['calm'] } },
    { name: 'è–‘æ±æ¡‚èŠ±å¥¶èŒ¶', shop: 'è¬æ³¢', price: 'M 50 / L 60', tags: { weather: ['cold'], body: ['sore_throat', 'digestive'], mood: ['calm'] } },
    { name: 'èŠ‹é ­ç‰›å¥¶', shop: 'è¿·å®¢å¤', price: 'M 65', tags: { weather: ['cool', 'cold'], body: ['tired'], mood: ['sad'] } },
    { name: 'æ±ºæ˜å¤§éº¥', shop: 'è¿·å®¢å¤', price: 'M 30 / L 35', tags: { weather: ['hot', 'rain'], body: ['digestive'], mood: ['calm'] } }
  ];

  const generateBtn = document.getElementById('generate');
  const resultArea = document.getElementById('resultArea');

  // 2. æ ¸å¿ƒé‚è¼¯ï¼šè¨ˆç®—è¦æ ¼ (å†°ã€ç³–ã€åŠ æ–™)
  function getDrinkAdvice(prefs) {
    let ice = "å¾®å†°", sugar = "å¾®ç³–", topping = "ä¸å»ºè­°åŠ æ–™";

    // å†°é‡é‚è¼¯
    if (prefs.body === 'sore_throat' || prefs.body === 'digestive' || prefs.weather === 'cold') ice = "ç†±é£²/æº«é£²";
    else if (prefs.weather === 'hot') ice = "å°‘å†°/å¾®å†°";
    else ice = "å»å†°";

    // ç”œåº¦é‚è¼¯
    if (prefs.body === 'tired' || prefs.mood === 'sad') sugar = "åŠç³– (è£œå……èƒ½é‡)";
    else if (prefs.body === 'digestive') sugar = "ç„¡ç³– (è¼•è² æ“”)";
    else sugar = "å¾®ç³–";

    // åŠ æ–™é‚è¼¯ (New!)
    if (prefs.body === 'sore_throat' || prefs.body === 'digestive') {
      topping = "å»ºè­°ä¸åŠ  (æˆ–é¸ä»™è‰/æ„›ç‰è¼ƒè»Ÿå¥½æ¶ˆåŒ–)";
    } else if (prefs.mood === 'stressed') {
      topping = "æ³¢éœ¸ã€çç ã€å¯’å¤© (åš¼å‹åè¶³è¶…ç´“å£“)";
    } else if (prefs.mood === 'sad' || prefs.body === 'tired') {
      topping = "å¸ƒä¸ã€å¥¶è“‹ã€èŠ‹æ³¥ (ç¶¿å¯†å£æ„Ÿå¸¶ä¾†å¹¸ç¦æ„Ÿ)";
    } else if (prefs.mood === 'happy') {
      topping = "æ¤°æœã€è˜†è–ˆã€èŒ¶å‡ (æ¸…çˆ½å½ˆç‰™å£æ„Ÿ)";
    } else {
      topping = "çç ã€å°ç²‰åœ“ (ç¶“å…¸åœ‹æ°‘çµ„åˆ)";
    }

    return { ice, sugar, topping };
  }

  function getSuggestions(prefs) {
    let candidates = DRINK_DATABASE.map(drink => {
      const matchW = drink.tags.weather.includes(prefs.weather);
      const matchB = drink.tags.body.includes(prefs.body);
      const matchM = drink.tags.mood.includes(prefs.mood);
      const score = (matchW ? 3 : 0) + (matchB ? 5 : 0) + (matchM ? 2 : 0);
      return { ...drink, score };
    }).filter(d => d.score >= 3);

    return candidates.sort((a, b) => b.score - a.score).sort(() => 0.5 - Math.random()).slice(0, 3);
  }

  function renderTable(items, advice) {
    if (items.length === 0) return '<p class="hint">æ‰¾ä¸åˆ°åŒ¹é…å»ºè­°ï¼Œè«‹å˜—è©¦æ›´æ›æ¢ä»¶ã€‚</p>';
    
    let html = `
      <table>
        <thead>
          <tr>
            <th>é£²æ–™å“é …</th>
            <th>é»ƒé‡‘æ¯”ä¾‹</th>
            <th>åŠ æ–™å»ºè­°</th>
          </tr>
        </thead>
        <tbody>`;

    items.forEach(it => {
      html += `
        <tr>
          <td>
            <span class="shop">${escapeHtml(it.name)}</span>
            <span class="small">${escapeHtml(it.shop)} | ${it.price}</span>
          </td>
          <td>
            <b style="color:var(--accent)">${advice.sugar}</b><br>
            <span class="small">${advice.ice}</span>
          </td>
          <td style="font-size: 13px; color: #d63384; font-weight: 500;">
            ${advice.topping}
          </td>
        </tr>`;
    });

    html += `</tbody></table><p class="hint">ğŸ’¡ å°æ’‡æ­¥ï¼šè‹¥ç•¶å¤©è…¸èƒƒè¼ƒå¼±ï¼Œå»ºè­°é¿é–‹æ³¢éœ¸ç­‰è¼ƒç¡¬çš„é…æ–™å–”ï¼</p>`;
    return html;
  }

  function escapeHtml(s) {
    return s ? s.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[c])) : '';
  }

  generateBtn.addEventListener('click', () => {
    const prefs = {
      weather: document.getElementById('weather').value,
      body: document.getElementById('body').value,
      mood: document.getElementById('mood').value
    };

    if (!prefs.weather || !prefs.body || !prefs.mood) {
      resultArea.innerHTML = '<p class="error">ï¼è«‹é¸æ“‡æ‰€æœ‰ç‹€æ…‹ã€‚</p>';
      return;
    }

    const suggestions = getSuggestions(prefs);
    const advice = getDrinkAdvice(prefs);
    resultArea.innerHTML = renderTable(suggestions, advice);
  });

  document.getElementById('reset').addEventListener('click', () => {
    document.getElementById('prefs').reset();
    resultArea.innerHTML = '';
  });
</script>
</body>
</html>

